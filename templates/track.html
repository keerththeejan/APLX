{% extends 'base.html' %}
{% block content %}
<section class="card">
  <h2>Track Shipment</h2>
  <form method="get" class="form-grid" action="{{ url_for('track') }}">
    <div class="form-row">
      <label for="awb">AWB Number</label>
      <input id="awb" name="awb" type="text" value="{{ awb or '' }}" placeholder="Enter AWB e.g., PRCL12345678" required />
    </div>
    <div class="form-actions">
      <button type="submit" class="btn">Search</button>
    </div>
  </form>
</section>

{% if shipment %}
<section class="card">
  <h2>Shipment Details</h2>
  <p><strong>AWB:</strong> {{ shipment.awb }}</p>
  <p><strong>From:</strong> {{ shipment.origin }} <strong>To:</strong> {{ shipment.destination }}</p>
  <p><strong>Sender:</strong> {{ shipment.sender_name }}{% if shipment.sender_phone %} ({{ shipment.sender_phone }}){% endif %}</p>
  <p><strong>Receiver:</strong> {{ shipment.receiver_name }}{% if shipment.receiver_phone %} ({{ shipment.receiver_phone }}){% endif %}</p>
  <p class="muted"><strong>Status:</strong> {{ shipment.status }} | <strong>Booked:</strong> {{ shipment.created_at.strftime('%Y-%m-%d %H:%M') }}</p>
</section>

<section class="card">
  <h2>Tracking Events</h2>
  {% if events %}
    <ul class="items">
      {% for e in events %}
        <li class="item">
          <div class="item-content">
            <strong>{{ e.status }}</strong>
            <p class="muted">{{ e.created_at.strftime('%Y-%m-%d %H:%M') }}{% if e.location %} @ {{ e.location }}{% endif %}</p>
            {% if e.note %}<p>{{ e.note }}</p>{% endif %}
          </div>
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p>No tracking events yet.</p>
  {% endif %}
</section>

<section class="card">
  <h2>Add Tracking Event</h2>
  <form method="post" action="{{ url_for('add_event', shipment_id=shipment.id) }}" class="form-grid">
    <div class="form-row">
      <label for="status">Status</label>
      <input id="status" name="status" type="text" placeholder="e.g., In Transit, Delivered" required />
    </div>
    <div class="form-row">
      <label for="location">Location</label>
      <input id="location" name="location" type="text" placeholder="City / Hub" />
    </div>
    <div class="form-row">
      <label for="note">Note</label>
      <textarea id="note" name="note" rows="2" placeholder="Optional note"></textarea>
    </div>
    <div class="form-actions">
      <button class="btn" type="submit">Add Event</button>
    </div>
  </form>
</section>
{% endif %}
{% endblock %}
