<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>All Notifications</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}" />
    <style>
        .notifications-page { padding: 24px; }
        .notifications-header { display:flex; align-items:center; justify-content:space-between; margin-bottom: 16px; }
        .notifications-list { display:flex; flex-direction:column; gap:12px; }
        .notification-item { background:#0f172a; border:1px solid #1f2937; border-radius:10px; padding:12px 14px; display:flex; gap:12px; align-items:flex-start; }
        .notification-item.unread { border-color:#22c55e; box-shadow: 0 0 0 1px rgba(34,197,94,0.2) inset; }
        .notification-type { font-size:20px; }
        .notification-content { flex:1; }
        .notification-title { font-weight:600; color:#e5e7eb; }
        .notification-message { color:#9ca3af; margin-top:4px; }
        .notification-meta { color:#6b7280; font-size:12px; margin-top:6px; }
        .no-items { color:#9ca3af; padding:24px; text-align:center; border:1px dashed #334155; border-radius:10px; }
        .back-link { color:#22c55e; text-decoration:none; }
    </style>
</head>
<body class="dashboard-body">
    <div class="notifications-page">
        <div class="notifications-header">
            <h1>Notifications</h1>
            <a class="back-link" href="{{ url_for('dashboard') }}">‚Üê Back to Dashboard</a>
        </div>
        {% if notifications and notifications|length > 0 %}
        <div class="notifications-list">
            {% for n in notifications %}
            <div class="notification-item {{ '' if n.is_read else 'unread' }}">
                <div class="notification-type">
                    {% if n.type == 'booking' %}üì¶{% elif n.type == 'shipment' %}üöö{% else %}üí¨{% endif %}
                </div>
                <div class="notification-content">
                    <div class="notification-title">{{ n.title }}</div>
                    <div class="notification-message">{{ n.message }}</div>
                    <div class="notification-meta">
                        <span class="js-time" title="" data-iso="{{ (n.created_at.replace(microsecond=0)).isoformat() }}Z">{{ n.created_at.strftime('%d %b %Y, %I:%M %p') }}</span>
                        {% if not n.is_read %} ‚Ä¢ Unread{% endif %}
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
            <div class="no-items">No notifications</div>
        {% endif %}
    </div>
    <script>
        (function() {
            function humanize(date) {
                const now = new Date();
                const diff = Math.floor((now - date) / 1000);
                if (diff < 60) return 'just now';
                const m = Math.floor(diff / 60);
                if (m < 60) return `${m}m ago`;
                const h = Math.floor(m / 60);
                if (h < 24) return `${h}h ago`;
                const d = Math.floor(h / 24);
                return `${d}d ago`;
            }
            function formatLocal(date) {
                return date.toLocaleString(undefined, {
                    year: 'numeric', month: 'short', day: '2-digit',
                    hour: '2-digit', minute: '2-digit'
                });
            }
            document.querySelectorAll('.js-time').forEach(el => {
                const iso = el.getAttribute('data-iso');
                if (!iso) return;
                const d = new Date(iso);
                el.textContent = humanize(d);
                el.title = formatLocal(d);
            });
        })();
    </script>
</body>
</html>
